<main class="container">
  <h2>Productos</h2>
  <div class="products">
    <aside class="filters">

      <div class="filter-group">
        <strong>Buscar por nombre</strong><br />
        <input type="text" [(ngModel)]="nombreBuscado" (input)="onBuscarNombre()" placeholder="Ej: Labial rojo"
          style="width: 100%; padding: 0.3em; margin-bottom: 1em;" />
      </div>

      <h4>Filtrar por</h4>


      <div class="filter-group">
        <strong>CategorÃ­a</strong><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'labial')"
            [checked]="categoriasSeleccionadas.has('labial')" />
          Labiales
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'bases')"
            [checked]="categoriasSeleccionadas.has('bases')" />
          Bases
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'corrector')"
            [checked]="categoriasSeleccionadas.has('corrector')" />
          Correctores
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'contorno')"
            [checked]="categoriasSeleccionadas.has('contorno')" />
          Contornos
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'rimel')"
            [checked]="categoriasSeleccionadas.has('rimel')" />
          Rimels
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'brochas')"
            [checked]="categoriasSeleccionadas.has('brochas')" />
          Brochas de Maquillaje
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'delineador')"
            [checked]="categoriasSeleccionadas.has('delineador')" />
          Delineadores de ojos
        </label><br />
        <label>
          <input type="checkbox" (change)="onCategoriaChange($event, 'polvo')"
            [checked]="categoriasSeleccionadas.has('polvo')" />
          Polvos
        </label>
      </div>


      <div class="filter-group">
        <strong>Marca</strong><br />
        <label>
          <input type="checkbox" (change)="onMarcaChange($event, 'Natura')"
            [checked]="marcasSeleccionadas.has('natura')" /> Natura
        </label><br />
        <label>
          <input type="checkbox" (change)="onMarcaChange($event, 'Dapop')"
            [checked]="marcasSeleccionadas.has('dapop')" /> Dapop
        </label><br />
        <label>
          <input type="checkbox" (change)="onMarcaChange($event, 'Rimel')"
            [checked]="marcasSeleccionadas.has('rimel')" /> Rimel
        </label><br />
        <label>
          <input type="checkbox" (change)="onMarcaChange($event, 'Renova')"
            [checked]="marcasSeleccionadas.has('renova')" /> Renova
        </label><br />
        <label>
          <input type="checkbox" (change)="onMarcaChange($event, 'Maybelline')"
            [checked]="marcasSeleccionadas.has('maybelline')" /> Maybelline
        </label>
      </div>

      <div class="filter-group">
        <strong>Ordenar por</strong><br />
        <label>
          <input type="radio" name="orden" (change)="ordenarProductos('menor')"
            [checked]="ordenSeleccionado === 'menor'" />
          Precio: menor a mayor
        </label><br />
        <label>
          <input type="radio" name="orden" (change)="ordenarProductos('mayor')"
            [checked]="ordenSeleccionado === 'mayor'" />
          Precio: mayor a menor
        </label>
      </div>
    </aside>


    <section class="products-list">
      @for (producto of productosFiltrados; track producto.id) {
      <div class="product-card" style="background-color: white;">
        <img [src]="'http://localhost:5000' + producto.imagen" alt="{{ producto.nombre }}" width="300" height="180" />
        <h3>{{ producto.nombre }}</h3>
        <p>{{ producto.descripcion }}</p>
        <p><strong>$ {{ producto.precio }}</strong></p>

        <div class="cantidad-control">
          <button (click)="restarCantidad(producto.id)" [disabled]="getCantidad(producto.id) <= 1">-</button>
          <input type="number" [value]="getCantidad(producto.id)" min="1" readonly
            style="width: 3em; text-align: center;" />
          <button (click)="sumarCantidad(producto.id)">+</button>
        </div>
        
        <button (click)="agregarAlCarrito(producto)" class="btn-carrito"> ðŸ›’ Agregar al carrito</button>
      </div>
      }
      @if (productosFiltrados.length === 0) {
      <div class="mensaje-vacio">
        ðŸ«£ No encontramos productos que coincidan con tu bÃºsqueda.
      </div>
      }

    </section>
  </div>
</main>